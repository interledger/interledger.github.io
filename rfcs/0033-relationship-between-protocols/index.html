<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The protocol for connecting blockchains and other ledgers">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Custom styles -->
    <link href="/assets/css/custom.css" rel="stylesheet">

    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,600,700,900|Droid+Sans+Mono|Titillium+Web:400,300,600,900' rel='stylesheet' type='text/css'>

    <link href="/assets/favicon.png" rel="icon" type="image/x-icon">

    <!--  highlight js -->
    <link rel="stylesheet" href="/assets/css/monokai-sublime.css">

    <!-- fontawesome icons -->
    <link rel="stylesheet" href="/assets/fontawesome/css/font-awesome.min.css" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->




</head>

<body class="sidebar-primary ">

  <!-- <div class="container"> -->
        <nav class="navbar fixed-top navbar-expand-lg navbar-dark nav-innerpage">
            <div class="navbar-leftbg"><a href="/" class="navbar-brand"><img src="/assets/img/ilp_logo@2x.png" class="logo"  height="44" alt="Interledger" /></a></div>
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarHolder" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">

              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarHolder">
              <ul class="nav navbar-nav">
                    <li class="nav-item" ><a class="nav-link" href="/overview.html">Docs</a></li>
                    <li class="nav-item" ><a class="nav-link" href="/libraries.html">Tools</a></li>
                    <li class="nav-item" ><a class="nav-link" href="/community.html">Community</a></li>
                    <li class="nav-item"><a class="nav-link" target="_blank" href="https://github.com/interledger">Edit on Github</a></li>
                    <li class="nav-item"><a class="nav-link cornerlink" href="/getting-started.html">Get Started</a></li>
              </ul><!-- /.navbar-nav -->
              <div class="cornerbox"></div>
            </div>
            <div class="menu-overlay"></div>
        </nav>
    <!-- </div> -->

    <div class="container-fluid" role="document" id="main_content_wrapper">
        <div class="row">

        <aside class="sidebar col-md-4 col-lg-3 p-0 order-md-1" role="complementary">

    <div id="sidenav" class="tree_nav">
      <ul class=" sidebar_pagelist">
        <li class="nav-label">Quick Start</li>
        <li><a href="/overview.html">Overview</a></li>
        <li><a href="/getting-started.html">Getting Started</a></li>
      </ul>
      <ul class=" sidebar_pagelist">
        <li class="nav-label">Community Resources</li>
        <li><a class="external-link" href="https://medium.com/interledger-blog">Blog &amp; Tutorials<i class="fa fa-external-link" aria-hidden="true"></i></a></li>
        <li><a href="/libraries.html">Libraries &amp; Tools</a></li>
        <li><a href="/summit-2019.html">ILP Summit 2019 Videos</a></li>
      </ul>

      <div class="sidebar-nav-header">Specs</div>
      <ul class=" sidebar_pagelist sidebar_indent">
        <!--    <li><a href="/rfcs/0001-interledger-architecture/">Interledger Architecture</a></li> -->
        <li><a href="/rfcs/0027-interledger-protocol-4/">Interledger Protocol 4 (ILPv4)</a></li>
        <li><a href="/rfcs/0015-ilp-addresses/">Interledger Addresses</a></li>
        <li><a href="/rfcs/0029-stream/">STREAM Protocol</a></li>
        <li><a href="/rfcs/0009-simple-payment-setup-protocol/">Simple Payment Setup Protocol (SPSP)</a></li>
        <li><a href="/rfcs/0026-payment-pointers/">Payment Pointers</a></li>
        <li><a href="/rfcs/0028-web-monetization/">Web Monetization</a></li>
        <li><a href="/rfcs/0030-notes-on-oer-encoding/">Notes on OER encoding</a></li>
        <li><a href="/rfcs/0031-dynamic-configuration-protocol/">Dynamic Configuration Protocol (ILDCP)</a></li>
        <li><a href="/rfcs/0032-peering-clearing-settlement/">Peering, Clearing and Settlement</a></li>
        <li><a href="/rfcs/0035-ilp-over-http/">ILP over HTTP</a></li>
        <li><a href="/rfcs/0036-spsp-pull-payments/">SPSP Pull Payments</a></li>
        <li><a class="external-link" target="_blank" href="https://w3c.github.io/webpayments/proposals/interledger-payment-method.html">W3C Web Payments<i class="fa fa-external-link" aria-hidden="true"></i></a></li>

      </ul>
    </div>        </aside>

          <!-- main column -->
        <main class="main col-md-8  col-lg-6   order-md-3  " role="main" id="main_content_body">
  <article class="pt-3 p-md-3">
    <div class="content doc-content">
        <h1 id="relationship-between-protocols">Relationship between Protocols</h1>
<h2 id="prerequisites">Prerequisites</h2>
<p>This document assumes the reader is familiar with the following document:</p>
<ul>
<li><a href="/rfcs/0001-interledger-architecture/">Interledger Architecture</a></li>
</ul>
<h2 id="terminology">Terminology</h2>
<ul>
<li>A <strong>node</strong> is a participant in an Interledger network. It may be a <a href="/rfcs/0001-interledger-architecture/#connectors">connector</a>, a sender or a receiver.</li>
<li>A <strong>payment</strong> is sending value from one to another but it doesn't necessarily mean settled, as is explained below. In the Interledger network, a payment could mean a <strong>node-to-node</strong> payment or an <strong>end-to-end</strong> payment.</li>
<li>A <strong>node-to-node</strong> payment means the intention of transferring value of a node (a connector, an endpoint sender, or an endpoint receiver) to another node which is directly connected to the sender node.</li>
<li>An <strong>end-to-end</strong> payment means the intention of transferring value of an endpoint sender to an endpoint receiver.</li>
<li>A <strong>settlement</strong> is ensuring that one has the paid value. For instance, executing a transaction on a certain ledger that the payee has an account on.</li>
<li>A <strong>node-to-node</strong> payment is settled by means that the two nodes agreed upon. It is usually a ledger that tracks the amount that both nodes have.</li>
<li>An <strong>end-to-end</strong> payment is settled through a chain of settlements of intermediaries above, because the end-to-end payment is a chain of node-to-node payments.</li>
<li>Payments on the Interledger network could be bidirectional, thus settlements could be as well.</li>
<li>Refer to <a href="/rfcs/0001-interledger-architecture/">Interledger Architecture</a> and <a href="#perspective">Perspective</a>.</li>
</ul>
<h2 id="motivation">Motivation</h2>
<p>Because the Interledger Protocol suite consists of several protocols and some related specifications, it can be difficult to understand the relationship between each of the protocols. This document attempts to provide an overview and mental model of how the components fit together. It is primarily intended for implementers of parts of the Interledger stack but may also be useful for others who wish to understand how Interledger works as a whole. A mental model is what a reader assumes something to be, reading some explanation. The mental model helps the reader predicting the behavior of what is explained even if the details are not given at that time.</p>
<h2 id="scope">Scope</h2>
<p>The scope of this document is the explication of the relationship between the Interledger protocols, and the details for it are out of scope. Some references are given for it though. i.e. This document draws a whole, big picture of ILP.</p>
<h2 id="perspective">Perspective</h2>
<p>There are two diagrams, one is for the macro view that shows the main elements and its IP layer connections, another is for the micro view that shows protocols, the interaction between programs, and the other details.</p>
<p>The alphabets (A-C) and numbers (1-15), that are shown in the diagrams as <strong>red characters</strong>, are explained briefly in the <a href="#elements-and-brief-explanations">Elements and Brief Explanations</a> section.</p>
<h3 id="connections">Connections</h3>
<p><img alt="Perspective of connections" src="images/perspective-connections.svg"/></p>
<h3 id="protocols-and-details">Protocols and Details</h3>
<p>This is an enlarged diagram of the above diagram, that shows mainly <code>Node A</code>, <code>Node B</code>, and <code>Ledger B</code>.</p>
<p><img alt="Perspective of connections" src="images/perspective-protocols.svg"/></p>
<h3 id="elements-and-brief-explanations">Elements and Brief Explanations</h3>
<h4 id="connections_1">Connections</h4>
<ul>
<li>(A) BTP over WebSocket</li>
<li><strong>Node</strong> to <strong>Node</strong> connection</li>
<li>In order to exchange payments, configuration and routing information, a node MUST have secure communication channels with its peers. The current implementation uses WebSockets for it.</li>
<li>(B) Ledger specific connection</li>
<li><strong>Node</strong> to <strong>Ledger</strong> connection</li>
<li>A node needs the means to settle its payments. Therefore the node has a connection to a ledger. The type of connection varies depending on the ledger.</li>
<li>In the cases where blockchains are used for settlements, nodes MAY utilize payment channels because it is quicker and less expensive than issuing transactions every time the nodes want to settle.</li>
<li>(C) SPSP over HTTPS</li>
<li><strong>Application</strong> to <strong>SPSP Server</strong> connection</li>
<li>To determine end-to-end payment information such as a shared secret, a destination address and so forth, an application connects to SPSP server over HTTPS.</li>
</ul>
<h4 id="protocols">Protocols</h4>
<ul>
<li>Link Layer Protocol</li>
<li>(1) BTP<ul>
<li><a href="/rfcs/0023-bilateral-transfer-protocol/">Bilateral Transfer Protocol 2.0 (BTP/2.0)</a></li>
<li>BTP is used for transferring ILP packets and messages that are used for settlements and so on between two nodes.</li>
</ul>
</li>
<li>Core ILP Protocols</li>
<li>(2) ILP<ul>
<li><a href="/rfcs/0027-interledger-protocol-4/">Interledger Protocol V4 (ILPv4)</a></li>
<li>ILP is used for sending payment packets across multiple hops. Some other protocols, including those for node configuration and routing, are also built on top of ILP and use ILP packets to communicate that information between peers.</li>
</ul>
</li>
<li>(3) ILP Address<ul>
<li><a href="/rfcs/0015-ilp-addresses/">ILP Addresses</a></li>
<li>An ILP address identifies a node.</li>
</ul>
</li>
<li>Transport Layer Protocol</li>
<li>(4) STREAM<ul>
<li><a href="/rfcs/0029-stream/">STREAM - A Multiplexed Money and Data Transport for ILP</a></li>
<li>STREAM is a protocol built on top of ILP, and is used for transferring money and data bidirectionally from applications.</li>
</ul>
</li>
<li>Application Layer Protocols</li>
<li>(5) Application<ul>
<li>Applications MAY build their own protocols on top of STREAM, and put data of the protocols into the extensible data area of STREAM packets.</li>
</ul>
</li>
<li>(6) SPSP<ul>
<li><a href="/rfcs/0009-simple-payment-setup-protocol/">The Simple Payment Setup Protocol (SPSP)</a></li>
<li>SPSP is used to determine end-to-end payment information such as a shared secret, a destination address and so forth.</li>
</ul>
</li>
<li>Connector to Connector Protocol</li>
<li>(7) DCP<ul>
<li><a href="/rfcs/0031-dynamic-configuration-protocol/">Interledger Dynamic Configuration Protocol (ILDCP) v1</a></li>
<li>DCP is a protocol built on top of ILP, and is used in order to exchange node information such as an ILP address.</li>
<li>DCP data is put into the extensible data area of ILP packets.</li>
</ul>
</li>
<li>(8) RBP<ul>
<li>RBP is a protocol built on top of ILP, and is used for transferring routing information to build routing tables.</li>
<li>RBP data is put into the extensible data area of ILP packets.</li>
</ul>
</li>
</ul>
<h4 id="data-structure-and-encoding">Data Structure and Encoding</h4>
<ul>
<li>(9) ASN.1</li>
<li><a class="external-link" href="https://www.itu.int/en/ITU-T/asn1/" target="_blank">ASN.1 Project <i aria-hidden="true" class="fa fa-external-link"></i></a></li>
<li>ASN.1 is used in order to specify data structure (order, type, and length).</li>
<li>Concrete packet structure of protocols is defined using ASN.1.<ul>
<li><a href="../asn1/README.md">asn1</a></li>
</ul>
</li>
<li>(10) Canonical OER</li>
<li><a href="/rfcs/0030-notes-on-oer-encoding/">Notes on OER Encoding</a></li>
<li>ASN.1 doesn't specify its encoding rule. i.e. How packets are encoded in binary is defined separately.</li>
<li>Canonical OER is one of the specifications that define the encoding rule.</li>
</ul>
<h4 id="functions">Functions</h4>
<p>The functions shown below are just concepts, so their exact form may differ between implementations.</p>
<ul>
<li>(11) Account Module</li>
<li>An account module manages connections to both a counterpart node and a ledger.</li>
<li>(12) Bilateral Ledger</li>
<li><a href="/rfcs/0023-bilateral-transfer-protocol/#terminology">Bilateral Transfer Protocol 2.0 (BTP/2.0)</a></li>
<li>A bilateral ledger tracks the balance of two nodes connected to each other, including unsettled node-to-node payments.</li>
<li>(13) Routing Table Module</li>
<li>A routing table module aggregates incoming routing information and builds the best routes for prefixes.</li>
<li>(14) Configuration Module</li>
<li><a href="/rfcs/0031-dynamic-configuration-protocol/">Interledger Dynamic Configuration Protocol (ILDCP) v1</a></li>
<li>A configuration module retrieves an ILP address that the node should use and the other information from the parent node.</li>
<li>(15) SPSP Server</li>
<li><a href="/rfcs/0009-simple-payment-setup-protocol/">The Simple Payment Setup Protocol (SPSP)</a></li>
<li>An SPSP server provides end-to-end payment information such as a shared secret, a destination address and so forth over an HTTPS connection. The SPSP server entity MAY be different from the payee node entity. i.e. The payee node may not serve as an SPSP server.</li>
</ul>
    </div>
  </article>
        </main>

        <aside class="right-sidebar col-lg-3 order-lg-4 p-0" role="complementary">
  <div class="card" id="page-toc-wrapper">
    <div class="card-header">
      <h4>On This Page</h4>
    </div>
    <ul class="card-body">
      <li class="level-1"><a href="#relationship-between-protocols">Relationship between Protocols</a></li>
<li class="level-2"><a href="#prerequisites">Prerequisites</a></li>
<li class="level-2"><a href="#terminology">Terminology</a></li>
<li class="level-2"><a href="#motivation">Motivation</a></li>
<li class="level-2"><a href="#scope">Scope</a></li>
<li class="level-2"><a href="#perspective">Perspective</a></li>
<li class="level-3"><a href="#connections">Connections</a></li>
<li class="level-3"><a href="#protocols-and-details">Protocols and Details</a></li>
<li class="level-3"><a href="#elements-and-brief-explanations">Elements and Brief Explanations</a></li>

    </ul>
  </div>
        </aside>

        </div><!--/.row (main layout)-->
      </div>


<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="col-sm-9 col-xs-12 float-left footertext">
                    <p><img src="/assets/img/ilp_footer_logo@2x.png" height="44" alt="Interledger" align="left" /> Interledger Project<br><span>Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0.</a></span></p>
                </div>
                <div class="col-sm-3 col-xs-12 float-right">
                    <a href="https://twitter.com/interledger"><img src="/assets/img/Twitter.png"></a>
                    <a href="https://communityinviter.com/apps/interledger/interledger-working-groups-slack"><img src="/assets/img/Slack.png"></a>
                </div>
            </div>
        </div>
    </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/highlight.pack.js"></script>
<script src="/assets/js/custom.js"></script>
<!-- <script src="/assets/js/home.js"></script> -->
<!-- <script type="text/javascript" src="/assets/js/svg-animation.js"></script> -->

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-68500608-1', 'auto');
    ga('send', 'pageview');

</script>

</body>
</html>